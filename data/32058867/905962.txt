title: TrueCrypt
id: 905962
TrueCrypt is a discontinued source available freeware utility used for on the fly encryption OTFE It can create a virtual encrypted disk within a file encrypt a partition or encrypt the whole storage device pre boot authentication br On May the TrueCrypt website announced that the project was no longer maintained and recommended users find alternative solutions br Though development of TrueCrypt has ceased an independent audit of TrueCrypt published in March has concluded that no significant flaws are present Two projects forked from TrueCrypt VeraCrypt active and CipherShed abandoned br br br History br br TrueCrypt was initially released as version in February based on E M Encryption for the Masses Several versions and many additional minor releases have been made since then with the most current version being a br br br E M and SecurStar dispute br Original release of TrueCrypt was made by anonymous developers called the TrueCrypt Team Shortly after version was released in the TrueCrypt Team reported receiving email from Wilfried Hafner manager of SecurStar a computer security company According to the TrueCrypt Team Hafner claimed in the email that the acknowledged author of E M developer Paul Le Roux had stolen the source code from SecurStar as an employee It was further stated that Le Roux illegally distributed E M and authored an illegal license permitting anyone to base derivative work on the code and distribute it freely Hafner alleges all versions of E M always belonged only to SecurStar and Le Roux did not have any right to release it under such a license br This led the TrueCrypt Team to immediately stop developing and distributing TrueCrypt which they announced online through usenet TrueCrypt Team member David Tesa k stated that Le Roux informed the team that there was a legal dispute between himself and SecurStar and that he received legal advisement not to comment on any issues of the case Tesa k concluded that should the TrueCrypt Team continue distributing TrueCrypt Le Roux may ultimately be held liable and be forced to pay consequent damages to SecurStar To continue in good faith he said the team would need to verify the validity of the E M license However because of Le Roux s need to remain silent on the matter he was unable to confirm or deny its legitimacy keeping TrueCrypt development in limbo br Thereafter would be visitors reported trouble accessing the TrueCrypt website and third party mirrors appeared online making the source code and installer continually available outside of official sanction by the TrueCrypt Team br In the FAQ section of its website SecurStar maintains its claims of ownership over both E M and Scramdisk another free encryption program The company states that with those products SecurStar had a long tradition of open source software but that competitors had nothing better to do but to steal our source code causing the company to make its products closed source forcing potential customers to place a substantial order and sign a non disclosure agreement before being allowed to review the code for security br Le Roux himself has denied developing TrueCrypt in a court hearing in March in which he also confirmed he had written E M br br br Version br Months later on June TrueCrypt was released The new version contained a different digital signature from that of the original TrueCrypt Team with the developers now being referred to as the TrueCrypt Foundation The software license was also changed to the open source GNU General Public License GPL However given the wide range of components with differing licenses making up the software and the contested nature of the legality of the program s release a few weeks later on June version was released under the original E M license to avoid potential problems relating to the GPL license br Version a of the software was released on October on truecrypt sourceforge net sub domain By May the original TrueCrypt website returned and truecrypt sourceforge net redirected visitors to truecrypt org br br br End of life announcement br On May the TrueCrypt official website truecrypt org began redirecting visitors to truecrypt sourceforge net with a HTTP Moved Permanently status which warned that the software may contain unfixed security issues and that development of TrueCrypt was ended in May following Windows XP s end of support The message noted that more recent versions of Windows have built in support for disk encryption using BitLocker and that Linux and OS X had similar built in solutions which the message states renders TrueCrypt unnecessary The page recommends any data encrypted by TrueCrypt be migrated to other encryption setups and offered instructions on moving to BitLocker The SourceForge project page for the software at sourceforge net truecrypt was updated to display the same initial message and the status was changed to inactive The page also announced a new software version which only allows decryption br Initially the authenticity of the announcement and new software was questioned Multiple theories attempting to explain the reason behind the announcement arose throughout the tech community br Shortly after the end of life announcement of TrueCrypt Gibson Research Corporation posted an announcement titled Yes TrueCrypt is still safe to use and a Final Release Repository to host the last official non crippled version a of TrueCrypt They no longer host the final release repository as of br Truecrypt org has been excluded from the Internet Archive Wayback Machine Their exclusion policy says they exclude pages at site owner request br br br Operating systems br TrueCrypt supports Windows OS X and Linux operating systems Both bit and bit versions of these operating systems are supported except for Windows IA not supported and Mac OS X Snow Leopard runs as a bit process The version for Windows Windows Vista and Windows XP can encrypt the boot partition or entire boot drive br br br Independent implementations br There is an independent compatible implementation tcplay for DragonFly BSD and Linux br The Dm crypt module included in default Linux kernel supports a TrueCrypt target called tcw since Linux version br br br Encryption scheme br br br Algorithms br Individual ciphers supported by TrueCrypt are AES Serpent and Twofish Additionally five different combinations of cascaded algorithms are available AES Twofish AES Twofish Serpent Serpent AES Serpent Twofish AES and Twofish Serpent The cryptographic hash functions available for use in TrueCrypt are RIPEMD SHA and Whirlpool br br br Modes of operation br TrueCrypt currently uses the XTS mode of operation Prior to this TrueCrypt used LRW mode in versions through a and CBC mode in versions and earlier XTS mode is thought to be more secure than LRW mode which in turn is more secure than CBC mode br Although new volumes can only be created in XTS mode TrueCrypt is backward compatible with older volumes using LRW mode and CBC mode Later versions produce a security warning when mounting CBC mode volumes and recommend that they be replaced with new volumes in XTS mode br br br Keys br The header key and the secondary header key XTS mode are generated using PBKDF with a bit salt and or iterations depending on the underlying hash function used br br br Plausible deniability br TrueCrypt supports a concept called plausible deniability by allowing a single hidden volume to be created within another volume In addition the Windows versions of TrueCrypt have the ability to create and run a hidden encrypted operating system whose existence may be denied br The TrueCrypt documentation lists many ways in which TrueCrypt s hidden volume deniability features may be compromised e g by third party software which may leak information through temporary files thumbnails etc to unencrypted disks and possible ways to avoid this In a paper published in and focused on the then latest version v a and its plausible deniability a team of security researchers led by Bruce Schneier states that Windows Vista Microsoft Word Google Desktop and others store information on unencrypted disks which might compromise TrueCrypt s plausible deniability The study suggested the addition of a hidden operating system functionality this feature was added in TrueCrypt When a hidden operating system is running TrueCrypt also makes local unencrypted filesystems and non hidden TrueCrypt volumes read only to prevent data leaks The security of TrueCrypt s implementation of this feature was not evaluated because the first version of TrueCrypt with this option had only recently been released br There was a functional evaluation of the deniability of hidden volumes in an earlier version of TrueCrypt by Schneier et al that found security leaks br br br Identifying TrueCrypt volumes br When analyzed TrueCrypt volumes appear to have no header and contain random data TrueCrypt volumes have sizes that are multiples of due to the block size of the cipher mode and key data is either bytes stored separately in the case of system encryption or two kB headers for non system containers Forensics tools may use these properties of file size apparent lack of a header and randomness tests to attempt to identify TrueCrypt volumes Although these features give reason to suspect a file to be a TrueCrypt volume there are however some programs which exist for the purpose of securely erasing files by employing a method of overwriting file contents and free disk space with purely random data i e shred scrub thereby creating reasonable doubt to counter pointed accusations declaring a file made of statistically random data to be a TrueCrypt file br If a system drive or a partition on it has been encrypted with TrueCrypt then only the data on that partition is deniable When the TrueCrypt boot loader replaces the normal boot loader an offline analysis of the drive can positively determine that a TrueCrypt boot loader is present and so lead to the logical inference that a TrueCrypt partition is also present Even though there are features to obfuscate its purpose i e displaying a BIOS like message to misdirect an observer such as Non system disk or disk error these reduce the functionality of the TrueCrypt boot loader and do not hide the content of the TrueCrypt boot loader from offline analysis Here again the use of a hidden operating system is the suggested method for retaining deniability br br br Performance br TrueCrypt supports parallelized encryption for multi core systems and under Microsoft Windows pipelined read write operations a form of asynchronous processing to reduce the performance hit of encryption and decryption On newer processors supporting the AES NI instruction set TrueCrypt supports hardware accelerated AES to further improve performance The performance impact of disk encryption is especially noticeable on operations which would normally use direct memory access DMA as all data must pass through the CPU for decryption rather than being copied directly from disk to RAM br In a test carried out by Tom s Hardware although TrueCrypt is slower compared to an unencrypted disk the overhead of real time encryption was found to be similar regardless of whether mid range or state of the art hardware is in use and this impact was quite acceptable In another article the performance cost was found to be unnoticeable when working with popular desktop applications in a reasonable manner but it was noted that power users will complain br br br Incompatibility with FlexNet Publisher and SafeCast br br Installing third party software which uses FlexNet Publisher or SafeCast which are used for preventing software piracy on products by Adobe such as Adobe Photoshop can damage the TrueCrypt bootloader on Windows partitions drives encrypted by TrueCrypt and render the drive unbootable This is caused by the inappropriate design of FlexNet Publisher writing to the first drive track and overwriting whatever non Windows bootloader exists there br br br Security concerns br TrueCrypt is vulnerable to various known attacks which are also present in other disk encryption software releases such as BitLocker To prevent those the documentation distributed with TrueCrypt requires users to follow various security precautions Some of those attacks are detailed below br br br Encryption keys stored in memory br TrueCrypt stores its keys in RAM on an ordinary personal computer the DRAM will maintain its contents for several seconds after power is cut or longer if the temperature is lowered Even if there is some degradation in the memory contents various algorithms can intelligently recover the keys This method known as a cold boot attack which would apply in particular to a notebook computer obtained while in power on suspended or screen locked mode has been successfully used to attack a file system protected by TrueCrypt br br br Physical security br TrueCrypt documentation states that TrueCrypt is unable to secure data on a computer if an attacker physically accessed it and TrueCrypt is used on the compromised computer by the user again this does not apply to a common case of a stolen lost or confiscated computer The attacker having physical access to a computer can for example install a hardware software keylogger a bus mastering device capturing memory or install any other malicious hardware or software allowing the attacker to capture unencrypted data including encryption keys and passwords or to decrypt encrypted data using captured passwords or encryption keys Therefore physical security is a basic premise of a secure system Attacks such as this are often called evil maid attacks br br br Malware br TrueCrypt documentation states that TrueCrypt cannot secure data on a computer if it has any kind of malware installed Malware may log keystrokes thus exposing passwords to an attacker br br br The Stoned bootkit br The Stoned bootkit an MBR rootkit presented by Austrian software developer Peter Kleissner at the Black Hat Technical Security Conference USA has been shown capable of tampering TrueCrypt s MBR effectively bypassing TrueCrypt s full volume encryption Potentially every hard disk encryption software is affected by this kind of attack if the encryption software does not rely on hardware based encryption technologies like TPM or if the attack is made with administrative privileges while the encrypted operating system is running br Two types of attack scenarios exist in which it is possible to maliciously take advantage of this bootkit in the first one the user is required to launch the bootkit with administrative privileges once the PC has already booted into Windows in the second one analogously to hardware keyloggers a malicious person needs physical access to the user s TrueCrypt encrypted hard disk in this context this is needed to modify the user s TrueCrypt MBR with that of the Stoned bootkit and then place the hard disk back on the unknowing user s PC so that when the user boots the PC and types his her TrueCrypt password on boot the Stoned bootkit intercepts it thereafter because from that moment on the Stoned bootkit is loaded before TrueCrypt s MBR in the boot sequence The first type of attack can be prevented as usual by good security practices e g avoid running non trusted executables with administrative privileges The second one can be successfully neutralized by the user if he she suspects that the encrypted hard disk might have been physically available to someone he she does not trust by booting the encrypted operating system with TrueCrypt s Rescue Disk instead of booting it directly from the hard disk With the rescue disk the user can restore TrueCrypt s MBR to the hard disk br br br Trusted Platform Module br The FAQ section of the TrueCrypt website states that the Trusted Platform Module TPM cannot be relied upon for security because if the attacker has physical or administrative access to the computer and you use it afterwards the computer could have been modified by the attacker e g a malicious component such as a hardware keystroke logger could have been used to capture the password or other sensitive information Since the TPM does not prevent an attacker from maliciously modifying the computer TrueCrypt will not support the TPM br br br Security audits br In a graduate student at Concordia University published a detailed online report in which he states that he has confirmed the integrity of the distributed Windows binaries of version a br A crowdfunding campaign attempting to conduct an independent security audit of TrueCrypt was successfully funded in October A non profit organization called the Open Crypto Audit Project OCAP was formed calling itself a community driven global initiative which grew out of the first comprehensive public audit and cryptanalysis of the widely used encryption software TrueCrypt The organization established contact with TrueCrypt developers who welcomed the audit Phase I of the audit was successfully completed on April finding no evidence of backdoors or malicious code Matthew D Green one of the auditors added I think it s good that we didn t find anything super critical br One day after TrueCrypt s end of life announcement OCAP confirmed that the audit would continue as planned with Phase II expected to begin in June and wrap up by the end of September The Phase II audit was delayed but was completed April by NCC Cryptography Services This audit found no evidence of deliberate backdoors or any severe design flaws that will make the software insecure in most instances The French National Agency for the Security of Information Systems ANSSI stated that while TrueCrypt and a have previously attained ANSSI certification migration to an alternate certified product is recommended as a precautionary measure br According to Gibson Research Corporation Steven Barnhart wrote to an email address for a TrueCrypt Foundation member he had used in the past and received several replies from David According to Barnhart the main points of the email messages were that the TrueCrypt Foundation was happy with the audit it didn t spark anything and that the reason for the announcement was that there is no longer interest in maintaining the project br According to a study released September TrueCrypt includes two vulnerabilities in the driver that TrueCrypt installs on Windows systems allowing an attacker arbitrary code execution and privilege escalation via DLL hijacking In January the vulnerability was fixed in VeraCrypt but it remains unpatched in TrueCrypt s unmaintained installers br br br Legal cases br br br Operation Satyagraha br In July several TrueCrypt secured hard drives were seized from Brazilian banker Daniel Dantas who was suspected of financial crimes The Brazilian National Institute of Criminology INC tried unsuccessfully for five months to obtain access to his files on the TrueCrypt protected disks They enlisted the help of the FBI who used dictionary attacks against Dantas disks for over months but were still unable to decrypt them br br br United States v John Doe br In the United States th Circuit Court of Appeals ruled that a John Doe TrueCrypt user could not be compelled to decrypt several of his hard drives The court s ruling noted that FBI forensic examiners were unable to get past TrueCrypt s encryption and therefore were unable to access the data unless Doe either decrypted the drives or gave the FBI the password and the court then ruled that Doe s Fifth Amendment right to remain silent legally prevented the Government from making them do so br br br David Miranda br br On August David Miranda partner of journalist Glenn Greenwald was detained at London s Heathrow Airport by Metropolitan Police while en route to Rio de Janeiro from Berlin He was carrying with him an external hard drive said to be containing sensitive documents pertaining to the global surveillance disclosures sparked by Edward Snowden Contents of the drive were encrypted by TrueCrypt which authorities said renders the material extremely difficult to access Detective Superintendent Caroline Goode stated the hard drive contained around gigabytes of data of which only have been accessed to date She further stated the process to decode the material was complex and so far only documents have been reconstructed since the property was initially received br Guardian contributor Naomi Colvin concluded the statements were misleading stating that it was possible Goode was not even referring to any actual encrypted material but rather deleted files reconstructed from unencrypted unallocated space on the hard drive or even plaintext documents from Miranda s personal effects Greenwald supported this assessment in an interview with Democracy Now mentioning that the UK government filed an affidavit asking the court to allow them to retain possession of Miranda s belongings The grounds for the request were that they could not break the encryption and were only able to access of the documents that he was carrying which Greenwald said most of which were probably ones related to his school work and personal use br br br James DeSilva br In February an Arizona Department of Real Estate IT department employee James DeSilva was arrested on charges of sexual exploitation of a minor through the sharing of explicit images over the Internet His computer encrypted with TrueCrypt was seized and DeSilva refused to reveal the password Forensics detectives from the Maricopa County Sheriff s Office were unable to gain access to his stored files br br br Lauri Love br In October British Finnish activist Lauri Love was arrested by the National Crime Agency NCA on charges of hacking into a US department or agency computer and one count of conspiring to do the same The government confiscated all of his electronics and demanded he provide them with the necessary keys to decrypt the devices Love refused On May a District Judge Magistrate s Court rejected a request by the NCA that Love be forced to turn over his encryption keys or passwords to TrueCrypt files on an SD card and hard drives that were among the confiscated property br br br Druking br In the special prosecutor investigation for Druking in South Korea the special prosecutor decrypted some of the files encrypted by TrueCrypt by guessing the passphrase br The special prosecutor said the hidden volumes were especially difficult to deal with He decrypted some of encrypted files by trying words and phrases the druking group had used elsewhere as parts of the passphrase in order to make educated guesses br br br License and source model br TrueCrypt was released as source available under the TrueCrypt License which is unique to the TrueCrypt software As of version a the last full version of the software released Feb the TrueCrypt License was version It is not part of the panoply of widely used open source licenses The Free Software Foundation FSF states that it is not a free software license br Discussion of the licensing terms on the Open Source Initiative OSI s license discuss mailing list in October suggests that the TrueCrypt License has made progress towards compliance with the Open Source Definition but would not yet pass if proposed for certification as Open Source software According to current OSI president Simon Phipps br br it is not at all appropriate for TrueCrypt to describe itself as open source This use of the term open source to describe something under a license that s not only unapproved by OSI but known to be subject to issues is unacceptable As OSI director and open source expert Karl Fogel said The ideal solution is not to have them remove the words open source from their self description but rather for their software to be under an OSI approved open source license br As a result of its questionable status with regard to copyright restrictions and other potential legal issues major Linux distributions do not consider the TrueCrypt License free TrueCrypt is not included with Debian Ubuntu Fedora or openSUSE br br br End of life and license version br May announcement of discontinuation of TrueCrypt also came with a new version of the software Among the many changes to the source code from the previous release were changes to the TrueCrypt License including removal of specific language that required attribution of TrueCrypt as well as a link to the official website to be included on any derivative products forming a license version br Cryptographer Matthew Green who had help raise funds for TrueCrypt s audit noted a connection between TrueCrypt s refusal to change the license and their departure time warning They set the whole thing on fire and now maybe nobody is going to trust it because they ll think there s some big evil vulnerability in the code br On June the only alleged TrueCrypt developer still answering email replied to a message by Matthew Green asking for permission to use the TrueCrypt trademark for a fork released under a standard open source license Permission was denied which led to the two known forks being named VeraCrypt and CipherShed as well as a re implementation named tc play rather than TrueCrypt br br br Trademarks br In a US trademark for TrueCrypt was registered under the name of Ondrej Tesarik with a company name TrueCrypt Developers Association and a trademark on the key logo was registered under the name of David Tesarik with a company name TrueCrypt Developers Association br In the company name TrueCrypt Foundation was registered in the US by a person named David Tesarik The TrueCrypt Foundation non profit organization last filed tax returns in and the company was dissolved in br br br See also br Comparison of disk encryption software br br br br br br External links br Official website br Open Crypto Audit Project OCAP non profit organization promoting an audit of TrueCrypt br IsTrueCryptAuditedYet com website for the audit br Veracrypt official fork website br br br Archives br Past versions on FileHippo br Past versions on GitHub br Past versions on truecrypt ch br Last version on Gibson Research Corporation website br Partial mirror of the original TrueCrypt a online manual