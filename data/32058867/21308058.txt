title: Message Session Relay Protocol
id: 21308058
In computer networking the Message Session Relay Protocol MSRP is a protocol for transmitting a series of related instant messages in the context of a communications session An application instantiates the session with the Session Description Protocol SDP over Session Initiation Protocol SIP or other rendezvous methods br The MSRP protocol is defined in RFC MSRP messages can also be transmitted by using intermediaries peers by using the relay extensions defined in RFC br MSRP is used in the RCS context especially for the instant messaging file transfer and photo sharing features br br br Protocol design br MSRP syntax is similar to other IETF text based protocols such as SIP HTTP and RTSP br MSRP requires a reliable transport layer like TCP Each message is either a request or a response and uses URIs a message contains headers and a body that can carry any type of data including binary information br The first headers must be To Path and From Path and the last must be Content Type this significantly reduces the complexity of parsers Messages must also end with dash characters followed by a transaction identifier which appears in the first line these are followed by a continuation flag which is a single character and end of line CRLF This last line at the end of messages makes it rather simple to find and detect the message boundaries br An MSRP URI has a scheme which is msrp or msrps authority as defined by RFC which holds the IP domain name and possibly the port an optional session identifier the transport and additional optional parameters For example br msrp atlanta example com jshA weztas tcp br br msrp is the scheme br atlanta example com is the authority br jshA weztas is the session identifier br tcp is the transport br br br Usage in SIP br MSRP can be used within a SIP session br br to do instant messaging in a one to one or one to many mode br to do an attachment file transfer br to do some photo sharing e g Image Share based on prior exchange of capabilities between the user endpoints br MSRP session is set up through SIP s offer answer model The SDP m line media type is message and the protocol is either TCP MSRP for MSRP over TCP and TCP TLS MSRP for MSRP over secure TLS Furthermore the MSRP URI is specified in a path attribute br A full SDP example as provided by the RFC br br v br o alice IN IP alice example com br s br c IN IP alice example com br t br m message TCP MSRP br a accept types text plain br a path msrp alice example com s i ek a tcp br br The address and port are contained in the c and m lines but also in the path attribute on an a line Generally other media types use the c line and m line to describe the address and port but the MSRP RFC section says the path attribute is the authoritative source for MSRP br br br See also br SIP for Instant Messaging and Presence Leveraging Extensions SIMPLE br Session Initiation Protocol SIP br IP Multimedia Subsystem IMS br Rich Communication Suite RCS br br br 