title: Security Support Provider Interface
id: 14686186
Security Support Provider Interface SSPI is a component of Windows API that performs security related operations such as authentication br SSPI functions as a common interface to several Security Support Providers SSPs A Security Support Provider is a dynamic link library DLL that makes one or more security packages available to apps br br br Providers br The following SSPs are included in Windows br br NTLMSSP msv dll Introduced in Windows NT Provides NTLM challenge response authentication for Windows domains prior to Windows and for systems that are not part of a domain br Kerberos kerberos dll Introduced in Windows and updated in Windows Vista to support AES Performs authentication for Windows domains in Windows and later br NegotiateSSP secur dll Introduced in Windows Provides single sign on capability sometimes referred to as Integrated Windows Authentication especially in the context of IIS Prior to Windows it tries Kerberos before falling back to NTLM On Windows and later NEGOExts is introduced which negotiates the use of installed custom SSPs which are supported on the client and server for authentication br Secure Channel schannel dll Introduced in Windows and updated in Windows Vista to support stronger AES encryption and ECC This provider uses SSL TLS records to encrypt data payloads br TLS SSL Public key cryptography SSP that provides encryption and secure communication for authenticating clients and servers over the internet Updated in Windows to support TLS br Digest SSP wdigest dll Introduced in Windows XP Provides challenge response based HTTP and SASL authentication between Windows and non Windows systems where Kerberos is not available br CredSSP credssp dll Introduced in Windows Vista and available on Windows XP SP Provides single sign on and Network Level Authentication for Remote Desktop Services br Distributed Password Authentication DPA msapsspc dll Introduced in Windows Provides internet authentication using digital certificates br Public Key Cryptography User to User PKU U pku u dll Introduced in Windows Provides peer to peer authentication using digital certificates between systems that are not part of a domain br br br Comparison br SSPI is a proprietary variant of Generic Security Services Application Program Interface GSSAPI with extensions and very Windows specific data types It shipped with Windows NT and Windows with the NTLMSSP For Windows an implementation of Kerberos was added using token formats conforming to the official protocol standard RFC The Kerberos GSSAPI mechanism and providing wire level interoperability with Kerberos implementations from other vendors br The tokens generated and accepted by the SSPI are mostly compatible with the GSS API so an SSPI client on Windows may be able to authenticate with a GSS API server on Unix depending on the specific circumstances br One significant shortcoming of SSPI is its lack of channel bindings which makes some GSSAPI interoperability impossible br Another fundamental difference between the IETF defined GSSAPI and Microsoft s SSPI is the concept of impersonation In this model a server can operate with the full privileges of the authenticated client so that the operating system performs all access control checks e g when opening new files Whether these are less privileges or more privileges than that of the original service account depends entirely on the client In the traditional GSSAPI model when a server runs under a service account it cannot elevate its privileges and has to perform access control in a client specific and application specific fashion The obvious negative security implications of the impersonation concept are prevented in Windows Vista by restricting impersonation to selected service accounts Impersonation can be implemented in a Unix Linux model using the seteuid or related system calls While this means an unprivileged process cannot elevate its privileges it also means that to take advantage of impersonation the process must run in the context of the root user account br br br br br br External links br SSPI Reference on MSDN br SSPI Information and Win samples br Example of use of SSPI for HTTP authentification