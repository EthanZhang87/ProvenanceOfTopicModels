title: Secure Real-time Transport Protocol
id: 2560969
The Secure Real time Transport Protocol SRTP is a profile for Real time Transport Protocol RTP intended to provide encryption message authentication and integrity and replay attack protection to the RTP data in both unicast and multicast applications It was developed by a small team of Internet Protocol and cryptographic experts from Cisco and Ericsson It was first published by the IETF in March as RFC br Since RTP is accompanied by the RTP Control Protocol RTCP which is used to control an RTP session SRTP has a sister protocol called Secure RTCP SRTCP it securely provides the same functions to SRTP as the ones provided by RTCP to RTP br Utilization of SRTP or SRTCP is optional in RTP or RTCP applications but even if SRTP or SRTCP are used all provided features such as encryption and authentication are optional and can be separately enabled or disabled The only exception is the message authentication feature which is indispensable and required when using SRTCP br br br Data flow encryption br SRTP and SRTCP use Advanced Encryption Standard AES as the default cipher There are two cipher modes defined which allow the AES block cipher to be used as a stream cipher br br Segmented Integer Counter Mode br A typical counter mode which allows random access to any blocks which is essential for RTP traffic running over unreliable network with possible loss of packets In the general case almost any function can be used in the role of counter assuming that this function does not repeat for a large number of iterations But the standard for encryption of RTP data is just a usual integer incremental counter AES running in this mode is the default encryption algorithm with a default key size of bits and a default session salt key length of bits br f mode br A variation of output feedback mode enhanced to be seekable and with an altered initialization function The default values of the encryption key and salt key are the same as for AES in counter mode AES running in this mode has been chosen to be used in G mobile networks br Besides the AES cipher SRTP allows the ability to disable encryption outright using the so called null encryption cipher which can be assumed as an alternate supported cipher In fact the null encryption cipher does not perform any encryption the encryption algorithm functions as the identity function and copies the input stream to the output stream without any changes It is mandatory for this cipher mode to be implemented in any SRTP compatible system As such it can be used when the confidentiality guarantees ensured by SRTP are not required while other SRTP features such as authentication and message integrity may be used br Though SRTP can easily accommodate new encryption algorithms the SRTP standard states that new encryption algorithms may only be introduced through publication of a new companion standard track RFC which must clearly define the new algorithm br br br Authentication integrity and replay protection br The above listed encryption algorithms do not alone secure message integrity an attacker will not be able to decrypt data but may be able to forge or replay previously transmitted data Hence the SRTP standard also provides the means to secure the integrity of data and safety from replay br To authenticate the message and protect its integrity the HMAC SHA algorithm is used This produces a bit result which is then truncated to or bits to become the authentication tag appended to each packet The HMAC is calculated over the packet payload and material from the packet header including the packet sequence number To protect against replay attacks the receiver maintains the sequence numbers of previously received messages compares them with the sequence number in each new received message and admits the new message only if it has not been previously received This approach relies on the integrity protection to make it impossible to modify the sequence number without detection br br br Key derivation br A key derivation function is used to derive the different keys used in a crypto context SRTP and SRTCP encryption keys and salts SRTP and SRTCP authentication keys from one single master key in a cryptographically secure way Thus the key management protocol needs to exchange only one master key all the necessary session keys are generated by applying the key derivation function br Periodic application of the key derivation function prevents an attacker from collecting large amounts of ciphertext encrypted with one single session key This provides protection against certain attacks which are easier to carry out when a large amount of ciphertext is available Furthermore multiple applications of the key derivation function provides backwards and forward security in the sense that a compromised session key does not compromise other session keys derived from the same master key This means that even if an attacker managed to recover a session key he is not able to decrypt messages secured with previous and later session keys derived from the same master key Note that of course a leaked master key reveals all the session keys derived from it br SRTP relies on an external key management protocol to set up the initial master key Two protocols specifically designed to be used with SRTP are ZRTP and MIKEY There are also other methods to negotiate the SRTP keys There are several vendors which offer products that use the SDES key exchange method br br br DTLS SRTP br RFC has defined DTLS SRTP DTLS SRTP uses the DTLS protocol to deliver master key and allows public key authentication br br br Interoperability and applications br See Comparison of VoIP software Secure VoIP software for phones servers and applications that support SRTP br br br Telephony VoIP br Asterisk PBX br br br Web browser support br br Known browsers with SRTP support of some kind br br Blink browser engine family br Chromium web browser supporting but not universally SRTP experimentally since br Opera web browser br Vivaldi web browser br Web browser families with some level of SRTP in the mainline updating branches from the core rendering system br br Gecko software br MSHTML superseded but minimal support existed at time of expiration br WebKit br So far no known SRTP support exists for text based web browsers Although SRTP could be used to operate in a VPN in conjunction with web browsers no VPN networks are known to be using it br br br Standards documents br RFC Proposed Standard The Secure Real time Transport Protocol SRTP br RFC Proposed Standard Integrity Transform Carrying Roll Over Counter for the Secure Real time Transport Protocol SRTP br RFC Standard RTP Profile for Audio and Video Conferences with Minimal Control br RFC Standard RTP A Transport Protocol for Real Time Applications br RFC Informational HMAC Keyed Hashing for Message Authentication br RFC Proposed Standard AES GCM Authenticated Encryption in the Secure Real time Transport Protocol SRTP br br br 