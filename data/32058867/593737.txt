title: S/MIME
id: 593737
S MIME Secure Multipurpose Internet Mail Extensions is a standard for public key encryption and signing of MIME data S MIME is on an IETF standards track and defined in a number of documents most importantly RFC It was originally developed by RSA Data Security and the original specification used the IETF MIME specification with the de facto industry standard PKCS secure message format Change control to S MIME has since been vested in the IETF and the specification is now layered on Cryptographic Message Syntax CMS an IETF specification that is identical in most respects with PKCS S MIME functionality is built into the majority of modern email software and interoperates between them Since it is built on CMS MIME can also hold an advanced digital signature br br br Function br S MIME provides the following cryptographic security services for electronic messaging applications br br Authentication br Message integrity br Non repudiation of origin using digital signatures br Privacy br Data security using encryption br S MIME specifies the MIME type application pkcs mime smime type enveloped data for data enveloping encrypting where the whole prepared MIME entity to be enveloped is encrypted and packed into an object which subsequently is inserted into an application pkcs mime MIME entity br br br S MIME certificates br Before S MIME can be used in any of the above applications one must obtain and install an individual key certificate either from one s in house certificate authority CA or from a public CA The accepted best practice is to use separate private keys and associated certificates for signature and for encryption as this permits escrow of the encryption key without compromise to the non repudiation property of the signature key Encryption requires having the destination party s certificate on store which is typically automatic upon receiving a message from the party with a valid signing certificate While it is technically possible to send a message encrypted using the destination party certificate without having one s own certificate to digitally sign in practice the S MIME clients will require the user to install their own certificate before they allow encrypting to others This is necessary so the message can be encrypted for both recipient and sender and a copy of the message can be kept in the sent folder and be readable for the sender br A typical basic class personal certificate verifies the owner s identity only insofar as it declares that the sender is the owner of the From email address in the sense that the sender can receive email sent to that address and so merely proves that an email received really did come from the From address given It does not verify the person s name or business name If a sender wishes to enable email recipients to verify the sender s identity in the sense that a received certificate name carries the sender s name or an organization s name the sender needs to obtain a certificate class from a CA who carries out a more in depth identity verification process and this involves making inquiries about the would be certificate holder For more detail on authentication see digital signature br Depending on the policy of the CA the certificate and all its contents may be posted publicly for reference and verification This makes the name and email address available for all to see and possibly search for Other CAs only post serial numbers and revocation status which does not include any of the personal information The latter at a minimum is mandatory to uphold the integrity of the public key infrastructure br br br S MIME Working Group of CA Browser Forum br In the S MIME Certificate Working Group of the CA Browser Forum was chartered to create a baseline requirement applicable to CAs that issue S MIME certificates used to sign verify encrypt and decrypt email That effort is intended to create standards including br br Certificate profiles for S MIME certificates and CAs that issue them br Verification of control over email addresses br Identity validation br Key management certificate lifecycle CA operational practices etc br Version of the Baseline Requirements for the Issuance and Management of Publicly Trusted S MIME Certificates was published on January by the CA Browser Forum It defined four types of S MIME certificate standards Mailbox validated Organization validated Sponsor validated and Individual validated br br br Obstacles to deploying S MIME in practice br br S MIME is sometimes considered not properly suited for use via webmail clients Though support can be hacked into a browser some security practices require the private key to be kept accessible to the user but inaccessible from the webmail server complicating the key advantage of webmail providing ubiquitous accessibility This issue is not fully specific to S MIME other secure methods of signing webmail may also require a browser to execute code to produce the signature exceptions are PGP Desktop and versions of GnuPG which will grab the data out of the webmail sign it by means of a clipboard and put the signed data back into the webmail page Seen from the view of security this is a more secure solution br S MIME is tailored for end to end security Logically it is not possible to have a third party inspecting email for malware and also have secure end to end communications Encryption will not only encrypt the messages but also the malware Thus if mail is not scanned for malware anywhere but at the end points such as a company s gateway encryption will defeat the detector and successfully deliver the malware The only solution to this is to perform malware scanning on end user stations after decryption Other solutions do not provide end to end trust as they require keys to be shared by a third party for the purpose of detecting malware Examples of this type of compromise are br Solutions which store private keys on the gateway server so decryption can occur prior to the gateway malware scan These unencrypted messages are then delivered to end users br Solutions which store private keys on malware scanners so that it can inspect messages content the encrypted message is then relayed to its destination br Due to the requirement of a certificate for implementation not all users can take advantage of S MIME as some may wish to encrypt a message without the involvement or administrative overhead of certificates for example by encrypting the message with a public private key pair instead br Any message that an S MIME email client stores encrypted cannot be decrypted if the applicable key pair s private key is unavailable or otherwise unusable e g the certificate has been deleted or lost or the private key s password has been forgotten However an expired revoked or untrusted certificate will remain usable for cryptographic purposes Indexing of encrypted messages clear text may not be possible with all email clients Neither of these potential dilemmas is specific to S MIME but rather cipher text in general and do not apply to S MIME messages that are only signed and not encrypted br S MIME signatures are usually detached signatures the signature information is separate from the text being signed The MIME type for this is multipart signed with the second part having a MIME subtype of application x pkcs signature Mailing list software is notorious for changing the textual part of a message and thereby invalidating the signature however this problem is not specific to S MIME and a digital signature only reveals that the signed content has been changed br br br Security issues br On May the Electronic Frontier Foundation EFF announced critical vulnerabilities in S MIME together with an obsolete form of PGP that is still used in many email clients Dubbed EFAIL the bug required significant coordinated effort by many email client vendors to fix Mitigations for both Efail vulnerabilities have since been addressed in the security considerations section of RFC br br br See also br CryptoGraf br DomainKeys Identified Mail for server handled email message signing br Email encryption br EFAIL a security issue in S MIME br GNU Privacy Guard GPG br Pretty Good Privacy PGP especially MIME Security with OpenPGP RFC br br br br br br External links br RFC Cryptographic Message Syntax CMS br RFC Cryptographic Message Syntax CMS Algorithms br RFC Secure Multipurpose Internet Mail Extensions S MIME Version Message Specification br RFC Secure Multipurpose Internet Mail Extensions S MIME Version Message Specification br Microsoft Exchange Server Understanding S MIME high level overview 