title: Office Open XML file formats
id: 24902683
The Office Open XML file formats are a set of file formats that can be used to represent electronic office documents There are formats for word processing documents spreadsheets and presentations as well as specific formats for material such as mathematical formulas graphics bibliographies etc br The formats were developed by Microsoft and first appeared in Microsoft Office They were standardized between December and November first by the Ecma International consortium where they became ECMA and subsequently after a contentious standardization process by the ISO IEC s Joint Technical Committee where they became ISO IEC br br br Container br br Office Open XML documents are stored in Open Packaging Conventions OPC packages which are ZIP files containing XML and other data files along with a specification of the relationships between them Depending on the type of the document the packages have different internal directory structures and names An application will use the relationships files to locate individual sections files with each having accompanying metadata in particular MIME metadata br A basic package contains an XML file called Content Types xml at the root along with three directories rels docProps and a directory specific for the document type for example in a docx word processing package there would be a word directory The word directory contains the document xml file which is the core content of the document br br Content Types xml br This file provided MIME type information for parts of the package using defaults for certain file extensions and overrides for parts specified by IRI br rels br This directory contains relationships for the files within the package To find the relationships for a specific file look for the rels directory that is a sibling of the file and then for a file that has the original file name with a rels appended to it For example if the content types file had any relationships there would be a file called Content Types xml rels inside the rels directory br rels rels br This file is where the package relationships are located Applications look here first Viewing in a text editor one will see it outlines each relationship for that section In a minimal document containing only the basic document xml file the relationships detailed are metadata and document xml br docProps core xml br This file contains the core properties for any Office Open XML document br word document xml br This file is the main part for any Word document br br br Relationships br An example relationship file word rels document xml rels is br br As such images referenced in the document can be found in the relationship file by looking for all relationships that are of type http schemas microsoft com office relationships image To change the used image edit the relationship br The following code shows an example of inline markup for a hyperlink br br In this example the Uniform Resource Locator URL is in the Target attribute of the Relationship referenced through the relationship Id rId in this case Linked images templates and other items are referenced in the same way br Pictures can be embedded or linked using a tag br br This is the reference to the image file All references are managed via relationships For example a document xml has a relationship to the image There is a rels directory in the same directory as document xml inside rels is a file called document xml rels In this file there will be a relationship definition that contains type ID and location The ID is the referenced ID used in the XML document The type will be a reference schema definition for the media type and the location will be an internal location within the ZIP package or an external location defined with a URL br br br Document properties br Office Open XML uses the Dublin Core Metadata Element Set and DCMI Metadata Terms to store document properties Dublin Core is a standard for cross domain information resource description and is defined in ISO br An example document properties file docProps core xml that uses Dublin Core metadata is br br br Document markup languages br An Office Open XML file may contain several documents encoded in specialized markup languages corresponding to applications within the Microsoft Office product line Office Open XML defines multiple vocabularies using namespaces and schema modules br The primary markup languages are br br WordprocessingML for word processing br SpreadsheetML for spreadsheets br PresentationML for presentations br Shared markup language materials include br br Office Math Markup Language OMML br DrawingML used for vector drawing charts and for example text art additionally though deprecated VML is supported for drawing br Extended properties br Custom properties br Variant Types br Custom XML data properties br Bibliography br In addition to the above markup languages custom XML schemas can be used to extend Office Open XML br br br Design approach br Patrick Durusau the editor of ODF has viewed the markup style of OOXML and ODF as representing two sides of a debate the element side and the attribute side He notes that OOXML represents the element side of this approach and singles out the KeepNext element as an example br br In contrast he notes ODF would use the single attribute fo keep next rather than an element for the same semantic br The XML Schema of Office Open XML emphasizes reducing load time and improving parsing speed In a test with applications current in April XML based office documents were slower to load than binary formats To enhance performance Office Open XML uses very short element names for common elements and spreadsheets save dates as index numbers starting from or from In order to be systematic and generic Office Open XML typically uses separate child elements for data and metadata element names ending in Pr for properties rather than using multiple attributes which allows structured properties Office Open XML does not use mixed content but uses elements to put a series of text runs element name r into paragraphs element name p The result is terse and highly nested in contrast to HTML for example which is fairly flat designed for humans to write in text editors and is more congenial for humans to read br The naming of elements and attributes within the text has attracted some criticism There are three different syntaxes in OOXML ECMA for specifying the color and alignment of text depending on whether the document is a text spreadsheet or presentation Rob Weir an IBM employee and co chair of the OASIS OpenDocument Format TC asks What is the engineering justification for this horror He contrasts with OpenDocument ODF uses the W C s XSL FO vocabulary for text styling and uses this vocabulary consistently br Some have argued the design is based too closely on Microsoft applications br In August the Linux Foundation published a blog post calling upon ISO National Bodies to vote No with comments during the International Standardization of OOXML It said OOXML is a direct port of a single vendor s binary document formats It avoids the re use of relevant existing international standards e g several cryptographic algorithms VML etc There are literally hundreds of technical flaws that should be addressed before standardizing OOXML including continued use of binary code tied to platform specific features propagating bugs in MS Office into the standard proprietary units references to proprietary confidential tags unclear IP and patent rights and much more br The version of the standard submitted to JTC was pages long The need and appropriateness of such length has been questioned Google stated that the ODF standard which achieves the same goal is only pages br br br WordprocessingML WML br Word processing documents use the XML vocabulary known as WordprocessingML normatively defined by the schema wml xsd which accompanies the standard This vocabulary is defined in clause of Part br br br SpreadsheetML SML br Spreadsheet documents use the XML vocabulary known as SpreadsheetML normatively defined by the schema sml xsd which accompanies the standard This vocabulary is described in clause of Part br Each worksheet in a spreadsheet is represented by an XML document with a root element named worksheet worksheet in the http schemas openxmlformats org spreadsheetml main Namespace br The representation of date and time values in SpreadsheetML has attracted some criticism ECMA st edition does not conform to ISO Representation of Dates and Times It requires that implementations replicate a Lotus bug that erroneously treats as a leap year Products complying with ECMA would be required to use the WEEKDAY spreadsheet function and therefore assign incorrect dates to some days of the week and also miscalculate the number of days between certain dates ECMA nd edition ISO IEC allows the use of Representation of Dates and Times in addition to the Lotus bug compatible form br br br Office MathML OMML br Office Math Markup Language is a mathematical markup language which can be embedded in WordprocessingML with intrinsic support for including word processing markup like revision markings footnotes comments images and elaborate formatting and styles br The OMML format is different from the World Wide Web Consortium W C MathML recommendation that does not support those office features but is partially compatible through XSL Transformations tools are provided with office suite and are automatically used via clipboard transformations br The following Office MathML example defines the fraction br br br br br br br br br br br br displaystyle frac pi br br br Some have queried the need for Office MathML OMML instead advocating the use of MathML a W C recommendation for the inclusion of mathematical expressions in Web pages and machine to machine communication Murray Sargent has answered some of these issues in a blog post which details some of the philosophical differences between the two formats br br br DrawingML br br DrawingML is the vector graphics markup language used in Office Open XML documents Its major features are the graphics rendering of text elements graphical vector based shape elements graphical tables and charts br The DrawingML table is the third table model in Office Open XML next to the table models in WordprocessingML and SpreadsheetML and is optimized for graphical effects and its main use is in presentations created with PresentationML markup br DrawingML contains graphics effects like shadows and reflection that can be used on the different graphical elements that are used in DrawingML br In DrawingML you can also create d effects for instance to show the different graphical elements through a flexible camera viewpoint br It is possible to create separate DrawingML theme parts in an Office Open XML package These themes can then be applied to graphical elements throughout the Office Open XML package br DrawingML is unrelated to the other vector graphics formats such as SVG These can be converted to DrawingML to include natively in an Office Open XML document This is a different approach to that of the OpenDocument format which uses a subset of SVG and includes vector graphics as separate files br A DrawingML graphic s dimensions are specified in English Metric Units EMUs It is so called because it allows an exact common representation of dimensions originally in either English or metric units defined as of a centimeter and thus there are EMUs per inch and EMUs per point to prevent round off in calculations Rick Jelliffe favors EMUs as a rational solution to a particular set of design criteria br Some have criticised the use of DrawingML and the transitional use only VML instead of W C recommendation SVG VML did not become a W C recommendation br br br Foreign resources br br br Non XML content br OOXML documents are typically composed of other resources in addition to XML content graphics video etc br Some have criticised the choice of permitted format for such resources ECMA st edition specifies Embedded Object Alternate Image Requests Types and Clipboard Format Types which refer to Windows Metafiles or Enhanced Metafiles each of which are proprietary formats that have hard coded dependencies on Windows itself The critics state the standard should instead have referenced the platform neutral standard ISO IEC Computer Graphics Metafile br br br Foreign markup br The Standard provides three mechanisms to allow foreign markup to be embedded within content for editing purposes br br Smart tags br Custom XML markup br Structured Document Tags br These are defined in clause of Part br br br Compatibility settings br Versions of Office Open XML contain what are termed compatibility settings These are contained in Part Markup Language Reference of ECMA st Edition but during standardization were moved to become a new part also called Part of ISO IEC Transitional Migration Features br These settings including element with names such as autoSpaceLikeWord footnoteLayoutLikeWW lineWrapLikeWord mwSmallCaps shapeLayoutLikeWW suppressTopSpacingWP truncateFontHeightsLikeWP uiCompat To useWord TableStyleRules useWord LineBreakRules wpJustification and wpSpaceWidth were the focus of some controversy during the standardisation of DIS As a result new text was added to ISO IEC to document them br An article in Free Software Magazine has criticized the markup used for these settings Office Open XML uses distinctly named elements for each compatibility setting each of which is declared in the schema The repertoire of settings is thus limited for new compatibility settings to be added new elements may need to be declared potentially creating thousands of them each having nothing to do with interoperability br br br Extensibility br The standard provides two types of extensibility mechanism Markup Compatibility and Extensibility MCE defined in Part ISO IEC and Extension Lists defined in clause of Part br br br 