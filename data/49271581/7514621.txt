title: Skype protocol
id: 7514621
The Skype protocol is a proprietary Internet telephony network used by Skype The protocol s specifications have not been made publicly available by Skype and official applications using the protocol are closed source br The Skype network is not interoperable with most other Voice over IP VoIP networks without proper licensing from Skype Numerous attempts to study or reverse engineer the protocol have been undertaken to reveal the protocol investigate security or allow unofficial clients br On June Microsoft announced the deprecation of the old Skype protocol Within several months from this date in order to continue using Skype services Skype users had to update to Skype applications released in and users were not able to log in to older Skype versions clients No announcement has been made on whether SmartTV and hardware phones with built in Skype functionality will continue to work without interruptions The new Skype protocol Microsoft Notification Protocol promised better offline messaging and better messages synchronization across Skype devices The deprecation became effective in the second week of August br br br Peer to peer architecture br Skype was the first peer to peer IP telephony network The network contains three types of entities supernodes ordinary nodes and the login server Each client maintains a host cache with the IP address and port numbers of reachable supernodes The Skype user directory is decentralized and distributed among the supernodes in the network Supernodes are grouped into slots supernodes and slots are grouped into blocks slots br Previously any client with good bandwidth no restrictions due to firewall or network address translation NAT and adequate processing power could become a supernode This placed an extra burden on those who connected to the Internet without NAT as Skype used their computers and Internet connections as third parties for UDP hole punching to directly connect two clients both behind NAT or to completely relay other users calls In Microsoft altered the design of the network and brought all supernodes under their control as hosted servers in data centres Microsoft at the time defended the move saying they believe this approach has immediate performance scalability and availability benefits for the hundreds of millions of users that make up the Skype community At the time there was some concern regarding the privacy implications of the change which appear to have been proven true with the revelation of the PRISM surveillance program in June br Skype does not support the use of the IPv protocol which would greatly reduce the complexity associated with the aforementioned IPv communication structure br Supernodes relay communications on behalf of two other clients both of which are behind firewalls or one to many network address translation br Without relaying by the supernodes two clients with firewall or NAT difficulties would be unable to make or receive calls from one another Skype tries to get the two ends to negotiate the connection details directly but sometimes the sum of problems at both ends can prevent direct conversation being established br The problems with firewalls and NAT can be br br The external port numbers or IP address are not derivable because NAT rewrites them br The firewall and NAT in use prevents the session being received br UDP is not usable due to NAT issues such as timeout br Firewalls block many ports br TCP through many to one NAT is always outward only by default adding port forwarding settings to the NAT router can allow reception of TCP sessions br br br Protocol br Signaling is encrypted using RC however the method only obfuscates the traffic as the key can be recovered from the packet Voice data is encrypted with AES br The Skype client s application programming interface API opens the network to software developers The Skype API allows other programs to use the Skype network to get white pages information and manage calls br The Skype code is closed source and the protocol is not standardized Parts of the client use Internet Direct Indy an open source socket communication library br On July a researcher from Benin Ouanilo Medegan released articles and proof of concept code results of his reverse engineering the Skype client br br br Protocol detection br Many networking and security companies claim to detect and control Skype s protocol for enterprise and carrier applications While the specific detection methods used by these companies are often proprietary Pearson s chi squared test and stochastic characterization with Naive Bayes classifiers are two approaches that were published in br br br Obfuscation layer br The RC encryption algorithm is used to obfuscate the payload of datagrams br br The CRC of public source and destination IP Skype s packet ID are taken br Skype obfuscation layer s initialization vector IV br The XOR of these two bit values is transformed to an byte RC key using an unknown key engine br A notable misuse of RC in Skype can be found on TCP streams UDP is unaffected The first bytes of which are known to the user since they consist of a hash of the username and password are XOR ed with the RC stream Then the cipher is reinitialized to encrypt the rest of the TCP stream br br br TCP br TCP packets br br TCP br Skype Init TCP packet br br The Skype Init TCP packet contains br br the seed bytes br init str string br br br Low level datagrams br Almost all traffic is ciphered Each command has its parameters appended in an object list The object list can be compressed br br Object List br Enc Cmd Encod br Compressed List br Frag br br Ack br br NAck br br Forward Forwarded Message br br br Object lists br An object can be a number string an IP port or even another object list Each object has an ID This ID identifies which command parameter the object is br br Object br Number br IP Port br List of numbers br String br RSA key br br Object List br List Size n br Object br br br Object n br br br Packet compression br Packets can be compressed The algorithm is a variation of arithmetic compression that uses reals instead of bits br br br Legal issues br Reverse engineering of the Skype protocol by inspecting disassembling binaries is prohibited by the terms and conditions of Skype s license agreement However European Union law allows reverse engineering a computer program without getting a permission from an author for inter operability purposes In the United States the Digital Millennium Copyright Act provides protections for reverse engineering software for the purposes of interoperability with other software There are also legal precedents in the United States when the reverse engineering is aimed at interoperability of file formats and protocols br In addition some countries specifically permit a program to be copied for the purposes of reverse engineering br br br Notes br br br br br br External links br Website containing articles and tools related to Skype protocol and behaviour analysis br Repository of articles on Skype analysis br Skype Architecture Inside