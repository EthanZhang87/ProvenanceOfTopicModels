title: Signal Protocol
id: 50607084
The Signal Protocol formerly known as the TextSecure Protocol is a non federated cryptographic protocol that provides end to end encryption for voice and instant messaging conversations The protocol was developed by Open Whisper Systems in and was introduced in the open source TextSecure app which later became Signal Several closed source applications have implemented the protocol such as WhatsApp which is said to encrypt the conversations of more than a billion people worldwide or Google who provides end to end encryption by default to all RCS based conversations between users of their Google Messages app for one to one conversations Facebook Messenger also say they offer the protocol for optional Secret Conversations as does Skype for its Private Conversations br The protocol combines the Double Ratchet Algorithm prekeys and a triple Elliptic curve Diffie Hellman DH handshake and uses Curve AES and HMAC SHA as primitives br br br History br The development of the Signal Protocol was started by Trevor Perrin and Moxie Marlinspike Open Whisper Systems in The first version of the protocol TextSecure v was based on Off the record messaging OTR br On February Open Whisper Systems introduced TextSecure v which migrated to the Axolotl Ratchet The design of the Axolotl Ratchet is based on the ephemeral key exchange that was introduced by OTR and combines it with a symmetric key ratchet modeled after the Silent Circle Instant Messaging Protocol SCIMP It brought about support for asynchronous communication offline messages as its major new feature as well as better resilience with distorted order of messages and simpler support for conversations with multiple participants The Axolotl Ratchet was named after the critically endangered aquatic salamander Axolotl which has extraordinary self healing capabilities The developers refer to the algorithm as self healing because it automatically disables an attacker from accessing the cleartext of later messages after having compromised a session key br The third version of the protocol TextSecure v made some changes to the cryptographic primitives and the wire protocol In October researchers from Ruhr University Bochum published an analysis of TextSecure v Among other findings they presented an unknown key share attack on the protocol but in general they found that it was secure br In March the developers renamed the protocol as the Signal Protocol They also renamed the Axolotl Ratchet as the Double Ratchet algorithm to better differentiate between the ratchet and the full protocol because some had used the name Axolotl when referring to the full protocol br As of October the Signal Protocol is based on TextSecure v but with additional cryptographic changes In October researchers from the UK s University of Oxford Australia s Queensland University of Technology and Canada s McMaster University published a formal analysis of the protocol concluding that the protocol was cryptographically sound br Another audit of the protocol was published in br br br Properties br The protocol provides confidentiality integrity authentication participant consistency destination validation forward secrecy post compromise security aka future secrecy causality preservation message unlinkability message repudiation participation repudiation and asynchronicity It does not provide anonymity preservation and requires servers for the relaying of messages and storing of public key material br The Signal Protocol also supports end to end encrypted group chats The group chat protocol is a combination of a pairwise double ratchet and multicast encryption In addition to the properties provided by the one to one protocol the group chat protocol provides speaker consistency out of order resilience dropped message resilience computational equality trust equality subgroup messaging as well as contractible and expandable membership br br br Authentication br For authentication users can manually compare public key fingerprints through an outside channel This makes it possible for users to verify each other s identities and avoid a man in the middle attack An implementation can also choose to employ a trust on first use mechanism in order to notify users if a correspondent s key changes br br br Metadata br The Signal Protocol does not prevent a company from retaining information about when and with whom users communicate There can therefore be differences in how messaging service providers choose to handle this information Signal s privacy policy states that recipients identifiers are only kept on the Signal servers as long as necessary in order to transmit each message In June Moxie Marlinspike told The Intercept the closest piece of information to metadata that the Signal server stores is the last time each user connected to the server and the precision of this information is reduced to the day rather than the hour minute and second br In October Signal Messenger announced that they had implemented a sealed sender feature into Signal which reduces the amount of metadata that the Signal servers have access to by concealing the sender s identifier The sender s identity is conveyed to the recipient in each message but is encrypted with a key that the server does not have This is done automatically if the sender is in the recipient s contacts or has access to their Signal Profile Users can also enable an option to receive sealed sender messages from non contacts and people who do not have access to their Signal Profile A contemporaneous wiretap of the user s device and or the Signal servers may still reveal that the device s IP address accessed a Signal server to send or receive messages at certain times br br br Usage br Open Whisper Systems first introduced the protocol in application TextSecure They later merged an encrypted voice call application named RedPhone into TextSecure and renamed it Signal br In November Open Whisper Systems announced a partnership with WhatsApp to provide end to end encryption by incorporating the Signal Protocol into each WhatsApp client platform Open Whisper Systems said that they had already incorporated the protocol into the latest WhatsApp client for Android and that support for other clients group media messages and key verification would be coming soon after On April WhatsApp and Open Whisper Systems announced that they had finished adding end to end encryption to every form of communication on WhatsApp and that users could now verify each other s keys In February WhatsApp announced a new feature WhatsApp Status which uses the Signal Protocol to secure its contents In October WhatsApp s parent company Facebook also deployed an optional mode called Secret Conversations in Facebook Messenger which provides end to end encryption using an implementation of the Signal Protocol br In September G Data Software launched a new messaging app called Secure Chat which used the Signal Protocol G Data discontinued the service in May br In September Google launched a new messaging app called Allo which featured an optional Incognito Mode that used the Signal Protocol for end to end encryption In March Google discontinued Allo in favor of their Google Messages app on Android In November Google announced that they would be using the Signal Protocol to provide end to end encryption by default to all RCS based conversations between users of their Google Messages app starting with one to one conversations br In January Open Whisper Systems and Microsoft announced the addition of Signal Protocol support to an optional Skype mode called Private Conversations br br br Influence br The Signal Protocol has had an influence on other cryptographic protocols In May Viber said that their encryption protocol is a custom implementation that uses the same concepts as the Signal Protocol Forsta s developers have said that their app uses a custom implementation of the Signal Protocol br The Double Ratchet Algorithm that was introduced as part of the Signal Protocol has also been adopted by other protocols OMEMO is an XMPP Extension Protocol XEP that was introduced in the Conversations messaging app and approved by the XMPP Standards Foundation XSF in December as XEP Matrix is an open communications protocol that includes Olm a library that provides optional end to end encryption on a room by room basis via a Double Ratchet Algorithm implementation The developers of Wire have said that their app uses a custom implementation of the Double Ratchet Algorithm br Messaging Layer Security an IETF proposal uses Asynchronous ratcheting trees to efficiently improve upon security guarantees over Signal s Double Ratchet br br br Implementations br Signal Messenger maintains a reference implementation of the Signal Protocol library written in Rust under the AGPLv license on GitHub There are bindings to Swift Java TypeScript C and other languages that use the reference Rust implementation br Signal maintained the following deprecated libraries br br libsignal protocol c A library written in C with additional licensing permissions for Apple s App Store br libsignal protocol java A library written in Java br There also exist alternative libraries written by third parties in other languages such as TypeScript br br br See also br Comparison of instant messaging protocols br Comparison of cryptography libraries br br br br br br Literature br br br External links br Official website br TextSecure Protocol Present and Future talk by Trevor Perrin at NorthSec video 