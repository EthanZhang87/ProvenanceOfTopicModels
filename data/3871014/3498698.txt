title: Caustic (optics)
id: 3498698
In optics a caustic or caustic network is the envelope of light rays which have been reflected or refracted by a curved surface or object or the projection of that envelope of rays on another surface The caustic is a curve or surface to which each of the light rays is tangent defining a boundary of an envelope of rays as a curve of concentrated light In some cases caustics can be seen as patches of light or their bright edges shapes which often have cusp singularities br br br Explanation br br Concentration of light especially sunlight can burn The word caustic in fact comes from the Greek burnt via the Latin causticus burning br A common situation where caustics are visible is when light shines on a drinking glass The glass casts a shadow but also produces a curved region of bright light In ideal circumstances including perfectly parallel rays as if from a point source at infinity a nephroid shaped patch of light can be produced Rippling caustics are commonly formed when light shines through waves on a body of water br Another familiar caustic is the rainbow Scattering of light by raindrops causes different wavelengths of light to be refracted into arcs of differing radius producing the bow br br br Computer graphics br br In computer graphics most modern rendering systems support caustics Some of them even support volumetric caustics This is accomplished by raytracing the possible paths of a light beam accounting for the refraction and reflection Photon mapping is one implementation of this Volumetric caustics can also be achieved by volumetric path tracing Some computer graphic systems work by forward ray tracing wherein photons are modeled as coming from a light source and bouncing around the environment according to rules Caustics are formed in the regions where sufficient photons strike a surface causing it to be brighter than the average area in the scene Backward ray tracing works in the reverse manner beginning at the surface and determining if there is a direct path to the light source Some examples of D ray traced caustics can be found here br The focus of most computer graphics systems is aesthetics rather than physical accuracy This is especially true when it comes to real time graphics in computer games where generic pre calculated textures are mostly used instead of physically correct calculations br br br Caustic engineering br Caustic engineering describes the process of solving the inverse problem to computer graphics That is given a specific image to determine a surface whose refracted or reflected light forms this image br In the discrete version of this problem the surface is divided into several micro surfaces which are assumed smooth i e the light reflected refracted by each micro surface forms a Gaussian caustic Gaussian caustic means that each micro surface obey Gaussian distribution The position and orientation of each of the micro surfaces are then obtained using a combination of Poisson integration and simulated annealing br There have been many different approaches to address the continuous problem One approach uses an idea from transportation theory called optimal transport to find a mapping between incoming light rays and the target surface After obtaining such a mapping the surface is optimized by adapting it iteratively using Snell s law of refraction br br br Optimal transport based caustic pattern design br br br Basic principle br Controlling caustic pattern is rather a challenging problem as very minor changes of the surface will significantly affect the quality of the pattern since light ray directions might be interfered by other light rays as they intersect with and refract through the material This will lead to a scattered discontinuous pattern To tackle this problem optimal transport based is one of the existing proposed methods to control caustic pattern by redirecting light s directions as it propagates through the surface of a certain transparent material This is done by solving an inverse optimization problem based on optimal transport Given a reference image of an object pattern the target is to formulate the mathematical description of the material surface through which light refracts and converges to the similar pattern of the reference image This is done by rearranging recomputing the initial light intensity until the minimum of the optimization problem is reached br br br Design pipeline br Here considering only refractive caustic the objective can be determined as follows similar principle for reflective caustic with different output br Input image of pattern to be obtained after propagating lights through the material given the light source position br Output caustic geometry on the receiver flat solid surface e g floor wall etc br In order to achieve the target pattern the surface where light refracts through and exits to the outer environment must be manufactured into certain shape to achieve desired pattern on the other side of the material br As mentioned given an input image this process will produce the similar caustic pattern as the output In principle there are two core stages with each includes two sub stages br br Solving Optimal Transport Problem br Compute Target Light Distribution br Compute Mapping from Initial Distribution to Target Distribution br Optimizing Target Surface br Compute Normal Representation of Surface br Surface Refinement br br br Solving optimal transport problem br As the case refraction occurs through a transparent surface for instance the patterns appearing under clear water surface main phenomena can be observed br br Very bright condensed light intensity points so called singularity br Curve like objects that connect the points br Regions with low light intensity br To perform computation the following quantities are being respectively introduced to describe the geometric characteristics of the pattern point singularity br br br br br br br p br br br br br displaystyle Phi p br br measuring light intensity at certain highly concentrated light point curve singularity br br br br br br br c br br br br br displaystyle Phi c br br measuring light intensity at around a light curve and irradiance measure br br br br br br br I br br br br br displaystyle Phi I br br measuring intensity in a certain poorly concentrated light area Putting them altogether the following function defines the total radiant flux measure br br br br br br br T br br br br br displaystyle Phi T br br at a certain section on the target surface br br br br br br br br T br br br br br br br br br br br i br br br br br br N br br br br br br br br br br p br br br i br br br br br br br br br br j br br br br br br N br br br br br br br br br br c br br br j br br br br br br br br br br I br br br br br br br br br br displaystyle Phi T Omega textstyle sum i N delta Phi p i Omega sum j N gamma Phi c j Omega Phi I Omega displaystyle br br br After this step there are two existing measures of the radiant flux measures of the source br br br br br br br S br br br br br displaystyle Phi S br br uniform distribution by initialization and the target br br br br br br br T br br br br br displaystyle Phi T br br computed in previous step What remains to compute is the mapping from the source to target In order to do this there are several quantities to be defined Firstly two light intensities evaluated by probabilities br br br br br br br S br br br br br displaystyle mu S br br light intensity evaluated by dividing br br br br br br br S br br br br br displaystyle Phi S br br by the flux of the union region between br br br br br br br S br br br br br displaystyle Phi S br br and br br br br br br br T br br br br br displaystyle Phi T br br br br br br br br br T br br br br br displaystyle mu T br br light intensity evaluated by dividing br br br br br br br T br br br br br displaystyle Phi T br br by the flux of the union region between br br br br br br br S br br br br br displaystyle Phi S br br and br br br br br br br T br br br br br displaystyle Phi T br br are defined Secondly the source mesh is generated as multiple sites br br br br br s br br i br br br br br br br br S br br br br br br br T br br br br br br displaystyle s i in Phi S cup Phi T br br which is later being deformed Next a power diagram br br br br br P br br w br br br br br displaystyle P w br br a set of br br br br br C br br i br br br w br br br br br displaystyle C i w br br power cells is defined on this set of sites br br br br br s br br i br br br br br displaystyle s i br br weighted by a weight vector br br br br br br br displaystyle omega br br Finally the goal is to decide whether which power cells are going to be move Considering all br br br br x br br br displaystyle x br br vertices on the surface finding the minimizer br br br br br br br m br i br n br br br br br displaystyle omega min br br of the following convex function will produce the matched power diagram for the target br br br br br f br br br br br br br br br s br br i br br br br S br br br br br br br i br br br br br br br S br br br br br C br br i br br br br br br br br br br br br C br br i br br br br br br br br br br x br br br s br br i br br br br br br br br br br br br br i br br br br d br br br br T br br br br x br br br br br displaystyle f omega sum s i in S omega i mu S C i int limits C i omega x s i omega i d mu T x br br br br Optimizing target surface br br After solving optimal transport problem the vertices are achieved However this gives no information about what the final surface should look like To achieve the desired target surface given the incoming light ray br br br br br d br br I br br br br br displaystyle d I br br outgoing light ray br br br br br d br br O br br br br br displaystyle d O br br and power diagram from the step above the surface normals representation can be computed according to Snell s law as br br br br br n br br br d br br I br br br br br br br br x br br br br br d br br I br br br br br br d br br T br br br br br br br br br d br br I br br br br br br br br x br br br br br d br br I br br br br br br br br br br x br br R br br br br x br br br br br br br br br br br x br br R br br br br x br br br br br br br br br br br br br br br br displaystyle n d I eta x over lVert d I eta d T rVert d I eta x over lVert d I eta x R x over x R x rVert br br br where br br br br br br br br displaystyle eta br br refraction coefficient br br br br br br x br br R br br br br br displaystyle x R br br target position obtained from solving above optimal transport problem br As the normal representation is obtained surface refinement is then achieved by minimizing the following compound energy function br br br br br br br br a br r br g br br m br a br x br br x br br br br br br br br br E br br i br n br t br br br br br br E br br d br i br r br br br br br br E br br f br l br u br x br br br br br br E br br r br e br g br br br br br br E br br b br a br r br br br br br br displaystyle underset x operatorname arg max omega cdot E int E dir E flux E reg E bar br br br where br br br br br br E br br i br n br t br br br br br br br v br br br M br br T br br br br br br br n br br o br br br br n br br br br br br br br br br br br displaystyle E int sum v in M T lVert n o n rVert br br is the integration energy that aligns the vertex normals br br br br br n br br o br br br br br displaystyle n o br br obtained from the Optimal Transport with the target normals br br br br n br br br displaystyle n br br obtained from the Snell s law computation above br br br br br br E br br d br i br r br br br br br br br v br br br M br br T br br br br br br x br br br br br proj br br br br br br x br br S br br br br br br d br br I br br br br br br br x br br br br br br br br br br br br br displaystyle E dir sum v in M T lVert x textbf proj x S d I x rVert br br as mesh generated in step Solving Optimal Transport cannot adapt to the sharp instances from the discontinuities this energy is to penalize the vertices to not change significantly from the incoming light ray br br br br br br E br br f br l br u br x br br br br br br br t br br br M br br T br br br br br br br br br T br br br br t br br br br br br S br br br br br t br br s br br br br br br br br br br br br br br br displaystyle E flux sum t in M T lVert Phi T t Phi S t s rVert br br is the energy measuring the flux over the triangle br br br br t br br br displaystyle t br br in the mesh br br br br br br E br br r br e br g br br br br br br br L br br br br br X br br br br br br br br br br br br br br displaystyle E reg lVert textbf L textbf X rVert br br is the energy that regularizes the shape of the triangles to maintain its well shapedness br br br br br br E br br b br a br r br br br br br br br v br br br M br br T br br br br br br m br a br x br br br br br l br o br g br br br br br br n br br R br br br br br x br br br x br br R br br br br br br br d br br T br H br br br br br br br br br br br br displaystyle E bar sum v in M T lVert max log n R x x R d TH rVert br br is barrier energy to ensure that surface does not deform beyond a certain distance threshold br br br br br d br br T br H br br br br br displaystyle d TH br br br br br Differentiable inverse rendering caustic pattern design br br br Basic principle br Inverse graphics is a method of observing the data from an image and inferring all possible properties including D geometry lighting materials and motion in order to generate a realistic image In conventional computer graphics to render an image with desired appearance and effects it is given all the relevant properties characteristics This could be described as the forward method On the contrary in caustic design the properties and characteristics of objects especially the material surface are not trivial The given constraint is the target image to obtain Therefore the goal is to obtain its properties and characteristics by observing and inferring the target image This can be considered the inverse backward method br The following is the basic loss function explaining how to optimize the parameters br br br br br L br br c br br br br f br br c br br br I br br br br br br br br br displaystyle L c lVert f c I rVert br br br where br br L c loss function mean square error of the rendered image and the target br c contains elements which can influence the generated image br I target image br br br Designed pipeline br br At first the target pattern is designed and the forward pass computed to get the synthetic pattern It s compared to the target pattern and get the loss br The objection is to let the synthetic pattern is similar to the target pattern as much as possible And then do the back propagation to get the optimized properties need to use in caustic manufacturing br br br Elements contributing to generated image br Appearance br br br br A br br br displaystyle A br br per pixel surface appearance is modeled as product of mipmapped texture and per pixel brightness br Geometry br br br br V br br br displaystyle V br br assume a D scene to be approximated by triangles parameterized by vertices br br br br V br br br displaystyle V br br br Camera br br br br C br br br displaystyle C br br focal length the point of view the center of the camera br There could be more elements for example albedo and refraction coefficient br br br General differentiable framework br Introduce U as an intermediate variable indicating D projected vertex coordinate positions The gradient of these properties can be derived by chain rule indirectly br br br br br br br br br f br br br br V br br br br br br br br br f br br br br U br br br br br br br br br U br br br br V br br br br br br displaystyle frac partial f partial V frac partial f partial U times frac partial U partial V br br br br br br br br br br f br br br br V br br br br br br br br br f br br br br A br br br br br br br br br A br br br br V br br br br br br displaystyle frac partial f partial V frac partial f partial A times frac partial A partial V br br br br br br br br br br f br br br br C br br br br br br br br br f br br br br U br br br br br br br br br U br br br br C br br br br br br displaystyle frac partial f partial C frac partial f partial U times frac partial U partial C br br br After applying the stochastic gradient descent the optimal br br br br A br br br displaystyle A br br br br br br V br br br displaystyle V br br and br br br br C br br br displaystyle C br br could be achieved Subsequently these quantities are used to carve or mill the material to generate the target pattern br br br Implementation br One common approach is to utilize the ability to perform differential operations in various deep learning auto differentiation frameworks libraries such as Tensorflow PyTorch Theano br One more approach is to make use of the OpenDR framework to build a forward graphics model and to automatically obtain derivatives with respect to the model parameters for optimization As optimization properties are obtained the target image can be generated OpenDR provides a local optimization method that can be incorporated into probabilistic programming frameworks This can be used to solve the problem of caustic br br br Manufacturing br br Once the caustic pattern has been designed computationally the processed data will be then sent to the manufacturing stage to get the final product The most common approach is subtractive manufacturing machining br Various materials can be used depending on the desired quality the effort it takes to manufacture and the available manufacturing method br br Common refractive materials acrylic polycarbonate polyethylene glass diamond br Common reflective materials steel iron aluminum gold silver titanium nickel br br Caustic pattern design has many real world applications for example in br br Luminaires br Jewelry br Architecture br Decorative glass production br br br See also br Focus optics br Circle of confusion br Caustic mathematics br br br br br Born Max Wolf Emil Principles of Optics Electromagnetic Theory of Propagation Interference and Diffraction of Light th ed Cambridge University Press ISBN br Nye John Natural Focusing and Fine Structure of Light Caustics and Wave Dislocations CRC Press ISBN br br br Further reading br Ferraro Pietro What a caustic The Physics Teacher Bibcode PhTea F doi br Dachsbacher Carsten Liktor G bor February Real time volume caustics with adaptive beam tracing Symposium on Interactive D Graphics and Games ACM 