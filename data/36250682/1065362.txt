title: End-to-end encryption
id: 1065362
End to end encryption E EE is a private communication system in which only communicating users can participate As such no one else including the communication system provider telecom providers Internet providers or malicious actors can access the cryptographic keys needed to converse End to end encryption is intended to prevent data being read or secretly modified other than by the true sender and recipient s The messages are encrypted by the sender but the third party does not have a means to decrypt them and stores them encrypted The recipients retrieve the encrypted data and decrypt it themselves Because no third parties can decipher the data being communicated or stored for example companies that provide end to end encryption are unable to hand over texts of their customers messages to the authorities br In the UK s Information Commissioner s Office the government body responsible for enforcing online data standards stated that opposition to E EE was misinformed and the debate too unbalanced with too little focus on benefits since E EE helped keep children safe online and law enforcement access to stored data on servers was not the only way to find abusers br br br E EE and privacy br In many messaging systems including email and many chat networks messages pass through intermediaries and are stored by a third party from which they are retrieved by the recipient Even if the messages are encrypted they are only encrypted in transit and are thus accessible by the service provider regardless of whether server side disk encryption is used Server side disk encryption simply prevents unauthorized users from viewing this information It does not prevent the company itself from viewing the information as they have the key and can simply decrypt this data br This allows the third party to provide search and other features or to scan for illegal and unacceptable content but also means they can be read and misused by anyone who has access to the stored messages on the third party system whether this is by design or via a backdoor This can be seen as a concern in many cases where privacy is very important such as in governmental and military communications financial transactions and when sensitive information such as health and biometric data are sent as a malicious actor or adversarial government could obtain such information sent in unencrypted messages br E EE alone does not guarantee privacy or security For example data may be held unencrypted on the user s own device or be accessible via their own app if their login is compromised br br br Etymology of the term br The term end to end encryption originally only meant that the communication is never decrypted during its transport from the sender to the receiver br For example around E EE has been proposed as an additional layer of encryption for GSM or TETRA in addition to the existing radio encryption protecting the communication between the mobile device and the network infrastructure This has been standardized by SFPG for TETRA Note that in TETRA E EE the keys are generated by a Key Management Centre KMC or a Key Management Facility KMF not by the communicating users br Later around the meaning of end to end encryption started to evolve when WhatsApp encrypted a portion of its network requiring that not only the communication stays encrypted during transport but also that the provider of the communication service is not able to decrypt the communications either by having access to the private key or by having the capability to undetectably inject an adversarial public key as part of a man in the middle attack This new meaning is now the widely accepted one br br br Modern usage br As of typical server based communications systems do not include end to end encryption These systems can only guarantee the protection of communications between clients and servers meaning that users have to trust the third parties who are running the servers with the sensitive content End to end encryption is regarded as safer because it reduces the number of parties who might be able to interfere or break the encryption In the case of instant messaging users may use a third party client or plugin to implement an end to end encryption scheme over an otherwise non E EE protocol br Some non E EE systems such as Lavabit and Hushmail have described themselves as offering end to end encryption when they did not Other systems such as Telegram and Google Allo have been criticized for not enabling end to end encryption by default Telegram did not enable end to end encryption by default on VoIP calls while users were using desktop software version but that problem was fixed quickly However as of Telegram still features no end to end encryption by default no end to end encryption for group chats and no end to end encryption for its desktop clients In Facebook Messenger came under scrutiny because the messages between a mother and daughter in Nebraska were used to seek criminal charges in an abortion related case against both of them The daughter told the police that she had a miscarriage and tried to search for the date of her miscarriage in her Messenger app Police suspected there could be more information within the messages and obtained and served a warrant against Facebook to gain access The messages allegedly mentioned the mother obtaining abortion pills for her daughter and then burning the evidence Facebook expanded default end to end encryption in the Messenger app just days later Writing for Wired Albert Fox Cahn criticized Messenger s approach to end to end encryption which was not enabled by default required opt in for each conversation and split the message thread into two chats which were easy to confuse for the user br Some encrypted backup and file sharing services provide client side encryption The encryption they offer is here not referred to as end to end encryption because the services are not meant for sharing messages between users However the term end to end encryption is sometimes incorrectly used to describe client side encryption br br br Challenges br br br Man in the middle attacks br End to end encryption ensures that data is transferred securely between endpoints But rather than try to break the encryption an eavesdropper may impersonate a message recipient during key exchange or by substituting their public key for the recipient s so that messages are encrypted with a key known to the attacker After decrypting the message the snoop can then encrypt it with a key that they share with the actual recipient or their public key in case of asymmetric systems and send the message on again to avoid detection This is known as a man in the middle attack MITM br br br Authentication br br Most end to end encryption protocols include some form of endpoint authentication specifically to prevent MITM attacks For example one could rely on certification authorities or a web of trust An alternative technique is to generate cryptographic hashes fingerprints based on the communicating users public keys or shared secret keys The parties compare their fingerprints using an outside out of band communication channel that guarantees integrity and authenticity of communication but not necessarily secrecy before starting their conversation If the fingerprints match there is in theory no man in the middle br When displayed for human inspection fingerprints usually use some form of Binary to text encoding These strings are then formatted into groups of characters for readability Some clients instead display a natural language representation of the fingerprint As the approach consists of a one to one mapping between fingerprint blocks and words there is no loss in entropy The protocol may choose to display words in the user s native system language This can however make cross language comparisons prone to errors br In order to improve localization some protocols have chosen to display fingerprints as base strings instead of more error prone hexadecimal or natural language strings An example of the base fingerprint called safety number in Signal and security code in WhatsApp would be br br br br br br Other applications such as Telegram instead encode fingerprints using emojis br Modern messaging applications can also display fingerprints as QR codes that users can scan off each other s devices br br br Endpoint security br The end to end encryption paradigm does not directly address risks at the communications endpoints themselves Each user s computer can still be hacked to steal their cryptographic key to create a MITM attack or simply read the recipients decrypted messages both in real time and from log files Even the most perfectly encrypted communication pipe is only as secure as the mailbox on the other end Major attempts to increase endpoint security have been to isolate key generation storage and cryptographic operations to a smart card such as Google s Project Vault However since plaintext input and output are still visible to the host system malware can monitor conversations in real time A more robust approach is to isolate all sensitive data to a fully air gapped computer PGP has been recommended by experts for this purpose However as Bruce Schneier points out Stuxnet developed by US and Israel successfully jumped air gap and reached Natanz nuclear plant s network in Iran To deal with key exfiltration with malware one approach is to split the Trusted Computing Base behind two unidirectionally connected computers that prevent either insertion of malware or exfiltration of sensitive data with inserted malware br br br Backdoors br A backdoor is usually a secret method of bypassing normal authentication or encryption in a computer system a product an embedded device etc Companies may also willingly or unwillingly introduce backdoors to their software that help subvert key negotiation or bypass encryption altogether In information leaked by Edward Snowden showed that Skype had a backdoor which allowed Microsoft to hand over their users messages to the NSA despite the fact that those messages were officially end to end encrypted br Following terrorist attacks in San Bernardino in and Pensacola in the FBI requested backdoors to Apple s iPhone software The company however refused to create a backdoor for the government citing concern that such a tool could pose risk for its consumers privacy br br br Compliance and regulatory requirements for content inspection br While E EE can offer privacy benefits that make it desirable in consumer grade services many businesses have to balance these benefits with their regulatory requirements For example many organizations are subject to mandates that require them to be able to decrypt any communication between their employees or between their employees and third parties br This might be needed for archival purposes for inspection by Data Loss Prevention DLP systems for litigation related eDiscovery or for detection of malware and other threats in the data streams For this reason some enterprise focused communications and information protection systems might implement encryption in a way that ensures all transmissions are encrypted with the encryption being terminated at their internal systems on premises or cloud based so they can have access to the information for inspection and processing br br br See also br Comparison of instant messaging protocols br Comparison of VoIP software Secure VoIP software a table overview of VoIP clients that offer end to end encryption br Diffie Hellman key exchange br End to end auditable voting systems br Point to point encryption br br br br br br Further reading br Ermoshina Ksenia Musiani Francesca Halpin Harry September End to End Encrypted Messaging Protocols An Overview PDF In Bagnoli Franco et al eds Internet Science INSCI Florence Italy Springer pp doi ISBN 